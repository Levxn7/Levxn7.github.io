---
title: NMS(非极大值抑制)和IOU(交并比)
date: 2024-04-02 10:31:18
categories: 
- 深度学习
tags:
- 目标检测
---

#### 前言
目标检测任务中常用的后处理方法NMS(非极大值抑制)和IOU(交井比)的概念。NMS的作用是删除冗余的候选框，保留置信度最高的候选框。通过计算BBOX之间的IOU，可以判断哪些候选框需要保留，哪些需要丢弃。在多类别目标检测任务中，需要分别对每个类别进行NMS计算，保留置信度最高的候选框。最后，只有保留的候选框才会被输出。

目标检测任务中常用的坐标损失计算方式，包括L1损失、L2损失、smoothL1损失、I0U损失、GIOU损失和DIOU损失。其中，smoothL1损失和IOU损失是基础损失和评估指标的组合，存在目标不一致的问题。GIOU损失解决了IOU损失在训练初期模型无法优化的问题，并能更好地评估模型的预测效果。DIOU损失是GIOU损失的一种变换形式，可用于计算目标检测的坐标损失。

#### 计算损失
目标检测任务中常用的坐标损失计算方式,包括**L1、L2损失、smooth L1损失**等,并分析了它们的优缺点。
L1损失和L2损失:L1损失和L2损失是最基础的损失函数，但存在一些问题。
![69e37af88c8570b1c4a67f61df98c965.png](69e37af88c8570b1c4a67f61df98c965.png)

为了避免模型学习优化和模型评估的目标不一致，我们最好也使用IOU来计算坐标损失并且，IOU Loss 是将 x，y, w, h这4个值构成的 bbox 看作是一个整体来进行损失计算的

SmoothL1损失是针对L1损失和L2损失的问题提出的一种损失函数。
在实际应用中，SmoothL1损失和L1损失、L2损失一样，都需要计算坐标损失。
![6a3b435a0f1517f8d0edcc250f5ef964.png](6a3b435a0f1517f8d0edcc250f5ef964.png)

但是IOU不能处理两个框不相交的情况，为了解决这种情况，所以使用GIOU，做一个外接框
![f1aee2a6b93376778efceb7be9b46a9f.png](f1aee2a6b93376778efceb7be9b46a9f.png)


当预测框与真实框为包含关系时，GIOU loss函数的分子为0，所以就退化为了IOU，所以，模型没办法针对这种情况进行区分，不能明确的知道两个框的位置关系到底是什样的，从而进行快速收敛。

DIOU和DIOU loss损失的计算方法，以及如何通过调整参数来平衡长宽比和面积一致性。
阿尔法参数的调整:介绍了如何通过调整阿尔法参数来平衡不同损失函数之间的权重
在计算DIOU时需要考虑距离的占比,以及引入阿尔法项的作用,最终得到了DLOU loss。
考虑距离的占比，即D的平方除以C的平方
阿尔法的作用，使损失函数更具区分度

![ace3e2368aafd2df1c4ce0b166cf770a.png](ace3e2368aafd2df1c4ce0b166cf770a.png)


CIOU loss的计算公式，包括减去IOU和加上阿尔法乘以v
![1195e45c140017820ccc4744e00e619f.png](1195e45c140017820ccc4744e00e619f.png)
